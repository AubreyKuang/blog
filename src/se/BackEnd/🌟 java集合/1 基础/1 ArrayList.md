# ArrayList

无参构造，长度为0的数组

> **以无参数构造方法创建 `ArrayList` 时，实际上初始化赋值的是一个空数组。当真正对数组进行添加元素操作时，才真正分配容量。即向数组中添加第一个元素时，数组容量扩为 10。**

如果传入集合，长度为集合大小



## 扩容

### Add自动扩容

\>\> 1找到一半 + 原来的长度

**ArrayList 每次扩容之后容量都会变为原来的 1.5 倍左右**



### addAll方法

在自动扩容、增加的长度之间选择较大值



## 迭代器

### failfast｜failsafe

fail-fast：一旦发现遍历同时其他修改，抛出异常

> ArrayList的模式⬆️

源码：记录了循环前后集合的**修改次数**，比较是否一致



fail-safe：发现时应对，为了完成遍历，例如牺牲一致性（遍历读取的数据不是最新）

源码：add方法复制原来的数组，长度+1，最新元素加到后面；读写分离



## 和LinkedList比较



![image-20230202183605834](https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/3978/image-20230202183605834.png)

因为Node存储本身数据，还有上下指针





### Arraylist

继承 RandomAccess 随机访问

随机访问快







## CPU读写

内存读写一次效率低，所以设置CPU缓存



数组：相邻数据也会读入CPU缓存区

链表：不会，因为存储空间可能不相邻